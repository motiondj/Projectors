# 블렌더 프로젝터 애드온 렌즈 관리 시스템 개발 계획서

## 1. 프로젝트 개요

### 1.1 목적
실제 프로젝터 렌즈 데이터를 블렌더 프로젝터 시뮬레이션 애드온에 효과적으로 연동하여, 현실적인 프로젝터 시뮬레이션을 구현하는 시스템 개발

### 1.2 현재 상황
- 기존 프로젝터 애드온은 프로젝터 생성 및 기본 설정(throw ratio, 렌즈 시프트 등) 지원
- 렌즈 관리 모듈(`lens_management`)이 부분적으로 구현되었으나 기존 프로젝터 시스템과 완전히 통합되지 않음
- 제조사별 렌즈 데이터가 JSON 파일로 저장되어 있으나 데이터 구조 표준화 필요
- 렌즈 데이터에 기반한 프로젝터 설정 제한 기능 미구현

### 1.3 개발 목표
- 렌즈 데이터와 프로젝터 시뮬레이션 시스템의 완전한 통합
- 렌즈 특성에 기반한 프로젝터 설정 제한 구현
- 사용자 친화적인 렌즈 관리 인터페이스 개발
- 데이터 구조 표준화 및 확장성 확보

## 2. 시스템 설계

### 2.1 모듈 구조
```
projector/
├── __init__.py           # 애드온 진입점
├── projector.py          # 핵심 프로젝터 기능
├── ui.py                 # 프로젝터 UI
├── operators.py          # 오퍼레이터 구현
├── helper.py             # 유틸리티 함수
└── lens_management/      # 렌즈 관리 시스템
    ├── __init__.py       # 렌즈 모듈 초기화
    ├── database.py       # 데이터 로드 및 관리
    ├── properties.py     # 렌즈 속성 정의
    ├── panel.py          # 프로젝터 탭용 패널
    ├── manager_panel.py  # 렌즈 관리 탭용 패널
    └── database/         # 렌즈 데이터 파일
        ├── epson.json    # 엡손 렌즈 데이터
        ├── panasonic.json # 파나소닉 렌즈 데이터
        ├── christie.json # 크리스티 렌즈 데이터
        └── ...           # 기타 제조사 데이터
```

### 2.2 데이터 흐름
1. 렌즈 데이터베이스 로드: 애드온 초기화 시 제조사별 JSON 파일 로드
2. 렌즈 선택: 사용자가 제조사 및 모델 선택
3. 데이터 적용: 선택된 렌즈의 사양을 프로젝터 설정에 적용
4. 제한 설정: 렌즈 특성에 맞게 프로젝터 설정의 유효 범위 제한
5. 피드백 제공: 설정이 렌즈 범위를 벗어날 경우 사용자에게 알림

### 2.3 데이터 구조 표준화
각 제조사별 JSON 파일 구조:
```json
{
  "MODEL_NUMBER": {
    "specs": {
      "focal_length": {"min": 값, "max": 값, "default": 값},
      "throw_ratio": {"min": 값, "max": 값, "default": 값},
      "f_stop": {"min": 값, "max": 값, "default": 값},
      "lens_shift": {
        "h_shift_range": [최소%, 최대%],
        "v_shift_range": [최소%, 최대%]
      },
      "supported_resolutions": ["1920x1080", "3840x2160", ...],
      "notes": "부가 설명"
    },
    "optical_properties": {
      "distortion": 값,
      "chromatic_aberration": 값,
      "vignetting": 값
    }
  }
}
```

## 3. 기능 구현 계획

### 3.1 렌즈 데이터 연동 시스템
- **목표**: 렌즈 데이터를 프로젝터 설정에 효과적으로 적용
- **구현 내용**:
  * 렌즈 선택 시 프로젝터 설정 자동 업데이트 메커니즘
  * 다양한 형식의 throw ratio 값 파싱 및 변환 로직
  * 렌즈 시프트 범위 매핑 및 적용 기능

### 3.2 렌즈 제한 기능
- **목표**: 선택된 렌즈의 물리적 특성에 맞게 프로젝터 설정 제한
- **구현 내용**:
  * throw ratio 및 렌즈 시프트의 유효 범위 설정
  * 범위 초과 시 자동 교정 또는 경고 메시지 표시
  * 프로젝터 설정 UI에 제한 범위 시각적 표시

### 3.3 렌즈 관리 인터페이스
- **목표**: 사용자가 렌즈 데이터를 쉽게 관리할 수 있는 인터페이스 제공
- **구현 내용**:
  * 새로운 탭에 렌즈 관리 패널 추가
  * 제조사 및 렌즈 모델 CRUD(생성, 읽기, 수정, 삭제) 기능
  * 렌즈 데이터 가져오기/내보내기 기능

### 3.4 설정 저장 및 로드 시스템
- **목표**: 프로젝터와 렌즈 설정을 일관되게 저장 및 로드
- **구현 내용**:
  * 블렌더 파일에 렌즈 선택 정보 저장
  * 파일 로드 시 선택된 렌즈 데이터 복원
  * 애드온 업데이트 시 데이터 호환성 유지

## 4. UI 설계

### 4.1 프로젝터 설정 탭 (기존 확장)
- 기존 프로젝터 설정 유지
- 렌즈 선택 섹션 추가:
  * 제조사 선택 드롭다운
  * 모델 선택 드롭다운
  * 선택된 렌즈 정보 표시
- 제한 범위 시각화:
  * throw ratio 및 렌즈 시프트 슬라이더에 유효 범위 표시
  * 범위 초과 시 경고 아이콘 표시

### 4.2 렌즈 관리 탭 (신규)
- 주요 섹션:
  * 제조사 목록
  * 선택된 제조사의 렌즈 모델 목록
  * 렌즈 사양 편집 인터페이스
  * 데이터 가져오기/내보내기 버튼
- 편집 인터페이스 구성:
  * 기본 정보: 모델명, 출시 연도 등
  * 광학 특성: focal length, throw ratio, f-stop 등
  * 렌즈 시프트 범위
  * 지원 해상도
  * 부가 정보 및 메모

## 5. 개발 단계 및 일정

### 5.1 1단계: 데이터 구조 표준화 및 기초 연동 (2주)
- JSON 데이터 구조 표준화
- 데이터 로드 메커니즘 개선
- 기본 렌즈 선택 → 프로젝터 설정 업데이트 구현

### 5.2 2단계: 렌즈 제한 기능 구현 (2주)
- throw ratio 제한 구현
- 렌즈 시프트 범위 제한 구현
- 사용자 피드백 메커니즘 구현

### 5.3 3단계: UI 개발 (3주)
- 프로젝터 탭 렌즈 선택 UI 통합
- 렌즈 관리 탭 구현
- 데이터 편집 인터페이스 구현

### 5.4 4단계: 테스트 및 최적화 (1주)
- 다양한 블렌더 버전 호환성 테스트
- 오류 처리 및 예외 상황 대응
- 성능 최적화

## 6. 확장 가능성 및 미래 계획

### 6.1 추가 기능 후보
- 렌즈 특성 기반 광학 왜곡 시뮬레이션
- 프로젝터 모델별 데이터베이스 확장
- 다양한 프로젝션 표면에 대한 시뮬레이션
- 렌즈 기반 자동 설정 추천 시스템

### 6.2 호환성 계획
- 블렌더 4.x 최적화
- 다국어 지원
- 외부 데이터 소스 연동

## 7. 리소스 및 참고자료

### 7.1 프로젝터 사양 관련 자료
- 제조사별 프로젝터 데이터시트
- 렌즈 사양 및 광학 특성 관련 문서
- 온라인 프로젝터 데이터베이스

### 7.2 블렌더 개발 참고자료
- 블렌더 애드온 개발 가이드
- API 문서
- 노드 시스템 관련 문서
