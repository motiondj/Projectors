# 블렌더 프로젝터 애드온 렌즈 관리 시스템 개발 체크리스트

## 1. 프로젝트 준비 단계
- [x] 현재 코드베이스 완전 분석 및 문서화
- [x] 개발 환경 설정 (블렌더 버전, 개발 도구 등)
- [x] 기존 `lens_management` 모듈과 `projector.py` 간의 인터페이스 지점 파악
- [x] 샘플 렌즈 데이터 수집 및 정리
- [x] 브랜치 전략 수립 (개발, 테스트, 배포)

## 2. 데이터 구조 표준화 (1단계)
- [x] JSON 스키마 정의
  - [x] 필수 필드 및 옵션 필드 결정
  - [x] 데이터 유형 및 형식 표준화 (예: throw ratio 형식)
  - [x] 샘플 JSON 파일 작성
- [x] 기존 JSON 파일 표준화
  - [x] Epson 렌즈 데이터 변환
  - [x] Panasonic 렌즈 데이터 변환
  - [x] Christie 렌즈 데이터 변환
  - [x] Barco 렌즈 데이터 변환
  - [x] Sony 렌즈 데이터 추가
- [x] 데이터 검증 유틸리티 구현
  - [x] JSON 형식 검증
  - [x] 필수 필드 존재 확인
  - [x] 값 범위 검증

## 3. 렌즈 데이터 로드 및 연동 (1단계)
- [x] 데이터베이스 로드 메커니즘 개선
  - [x] 제조사별 동적 로드 구현
  - [x] 캐싱 전략 구현
  - [x] 오류 처리 강화
- [x] 데이터 변환 로직 구현
  - [x] throw ratio 파싱 함수 개선
  - [x] 렌즈 시프트 값 변환 함수 구현
  - [x] focal length 및 기타 파라미터 변환
- [x] 프로젝터 설정 연동
  - [x] `update_lens_settings` 함수 재구현
  - [x] `projector.py`의 업데이트 함수와 통합
  - [x] 양방향 데이터 바인딩 구현

## 4. 렌즈 제한 기능 구현 (2단계)
- [x] throw ratio 제한 구현
  - [x] 렌즈 데이터에서 min/max 추출
  - [x] UI 슬라이더에 제한 적용
  - [x] 범위 초과 시 처리 로직 구현
- [x] 렌즈 시프트 제한 구현
  - [x] 수평/수직 시프트 범위 설정
  - [x] 제한 초과 시 자동 조정
  - [x] UI에 유효 범위 표시(향후 시각적 표현 개선 예정)
- [x] 기타 파라미터 제한
  - [x] 해상도 제한 (지원되는 해상도만 선택 가능)
  - [x] focal length 범위 제한
  - [x] 기타 파라미터 제한

## 5. 프로젝터 설정 UI 통합 (3단계)
- [x] 렌즈 선택 UI 구현
  - [x] 제조사 드롭다운 추가
  - [x] 모델 드롭다운 추가 (제조사 선택에 따라 동적 업데이트)
  - [x] 선택된 렌즈 정보 표시 영역 구현
- [x] 제한 범위 동작 구현
  - [x] 슬라이더 유효 범위 기능 구현
  - [x] 범위 초과 시 자동 조정 기능
  - [x] 범위 초과 시 시각적 피드백 제공 (슬라이더 빨간색 강조 표시)
- [x] UI 상호작용 개선
  - [x] 렌즈 선택 시 설정 자동 업데이트
  - [x] 제조사 선택 시 첫 번째 렌즈 자동 선택
  - [x] None 옵션 추가로 렌즈 선택 해제 지원
  - [x] 렌즈 선택 시 throw ratio 값을 렌즈의 최소값으로 자동 설정
  - [x] 렌즈 선택 시 렌즈 시프트 값을 중간값 또는 0으로 자동 설정

## 6. 렌즈 관리 패널 구현 (3단계)
- [x] 렌즈 관리 탭 생성
  - [x] 탭 등록 및 기본 UI 구성
  - [x] 제조사/모델 목록 표시 구현
  - [x] 데이터 관리 컨트롤 배치
- [x] 렌즈 데이터 표시 인터페이스
  - [x] 기본 정보 표시 필드
  - [x] 광학 특성 표시 필드
  - [x] 렌즈 시프트 범위 표시 컨트롤
  - [x] 지원 해상도 표시
- [x] 데이터 관리 기능
  - [x] 새 제조사 추가 기능
  - [x] 새 렌즈 모델 추가 기능
  - [x] 기존 데이터 편집 기능
  - [x] 데이터 삭제 기능
  - [x] 변경사항 저장 기능

## 7. 데이터 가져오기/내보내기 (3단계)
- [x] JSON 파일 가져오기
  - [x] 파일 선택 다이얼로그 구현
  - [x] 파일 형식 검증
  - [x] 데이터베이스에 통합
- [x] JSON 파일 내보내기
  - [x] 렌즈 데이터 직렬화
  - [x] 파일 저장 다이얼로그
  - [x] 전체/선택 데이터 내보내기 옵션
- [x] 사용자 데이터 관리
  - [x] 기본 데이터와 사용자 데이터 분리
  - [x] 사용자 데이터 우선순위 설정
  - [x] 충돌 해결 메커니즘

## 8. 설정 저장 및 로드 (4단계)
- [x] 블렌더 파일에 렌즈 선택 정보 저장
  - [x] 제조사/모델 정보 저장 구현
  - [x] 커스텀 설정 저장 구현
- [x] 파일 로드 시 데이터 복원
  - [x] 저장된 렌즈 정보 복원
  - [x] 존재하지 않는 렌즈 처리 로직
- [x] 블렌더 버전 간 호환성
  - [x] 버전 감지 메커니즘
  - [x] 버전별 API 차이 처리

## 9. 테스트 및 최적화 (4단계)
- [x] 기본 기능 테스트
  - [x] 데이터 로드/파싱 테스트
  - [x] 설정 업데이트 테스트
  - [x] UI 기능 테스트
- [x] 오류 처리 강화
  - [x] 예외 상황 처리
  - [x] 사용자 피드백 개선
- [x] UI 개선
  - [x] 렌즈 제한 범위 초과 시 시각적 피드백 제공
  - [x] 범위 초과 값이 있을 때 "Fix" 버튼으로 쉽게 조정 가능하게 함
- [x] 성능 최적화
  - [x] 메모리 사용량 분석 및 최적화 - 캐싱 메커니즘 개선
  - [x] CPU 사용량 최적화 - 재귀 호출 방지 로직 구현
  - [x] UI 반응성 개선 - enum 속성 관리 최적화

## 10. 문서화 및 배포
- [ ] 사용자 문서 작성 (향후 구현)
  - [ ] 렌즈 선택 및 적용 방법
  - [ ] 렌즈 데이터 관리 방법
  - [ ] 문제 해결 가이드
- [ ] 개발자 문서 작성 (향후 구현)
  - [ ] 코드 구조 설명
  - [ ] API 문서
  - [ ] 확장 가이드
- [ ] 배포 준비 (향후 구현)
  - [ ] 버전 번호 설정
  - [ ] 릴리스 노트 작성
  - [ ] 패키징 및 배포

## 11. 추가 기능 및 개선사항
- [x] 렌즈 선택 인터랙션 개선
  - [x] 렌즈 선택 시 throw ratio를 렌즈의 최소값으로 자동 설정
  - [x] 렌즈 선택 시 렌즈 시프트 값을 적절한 기본값으로 자동 설정
  - [x] 범위 초과 시 확실한 시각적 피드백 제공
- [ ] 광학 왜곡 시뮬레이션
  - [ ] 렌즈 특성 기반 왜곡 알고리즘 연구
  - [ ] 노드 기반 왜곡 구현
  - [ ] UI 컨트롤 추가
- [ ] 프로젝터 모델 데이터베이스
  - [ ] 프로젝터 모델 데이터 구조 설계
  - [ ] 렌즈-프로젝터 호환성 정보 추가
  - [ ] 프로젝터 선택 UI 구현
- [ ] 렌즈 추천 시스템
  - [ ] 추천 알고리즘 설계
  - [ ] 사용 시나리오별 최적 렌즈 추천
  - [ ] 추천 UI 구현

## 12. 완료된 파일 목록
- [x] lens_management/__init__.py - 렌즈 관리 모듈 초기화 및 등록
- [x] lens_management/database.py - 렌즈 데이터베이스 관리 클래스
- [x] lens_management/panel.py - 프로젝터 탭의 렌즈 선택 패널
- [x] lens_management/properties.py - 렌즈 관련 속성 정의 및 업데이트 로직 개선
- [x] lens_management/operators.py - 렌즈 관리 오퍼레이터 구현
- [x] lens_management/manager_panel.py - 렌즈 관리 전용 패널
- [x] lens_management/database/epson.json - Epson 렌즈 데이터
- [x] lens_management/database/panasonic.json - Panasonic 렌즈 데이터
- [x] lens_management/database/christie.json - Christie 렌즈 데이터
- [x] lens_management/database/barco.json - Barco 렌즈 데이터
- [x] lens_management/database/sony.json - Sony 렌즈 데이터 추가
- [x] projector.py - 프로젝터 기능 구현, Throw Ratio 및 렌즈 시프트 제한 업데이트
- [x] ui.py - 프로젝터 UI, 범위 초과 시 시각적 피드백 추가

## 13. 구현 세부 기능
- [x] 프로젝터 설정 속성 범위 확장
  - [x] `throw_ratio` 속성의 범위를 0.1~10.0으로 확장하여 다양한 렌즈 대응
  - [x] `h_shift`, `v_shift` 속성의 범위를 -150%~150%로 확장
- [x] 렌즈 선택 시 자동 값 설정
  - [x] 렌즈 선택 시 `throw_ratio`를 렌즈 최소값으로 자동 설정
  - [x] 렌즈 선택 시 렌즈 시프트를 중간값 또는 0으로 자동 설정
- [x] 범위 초과 시 UI 피드백
  - [x] 범위 초과 시 슬라이더 빨간색 강조 표시
  - [x] 범위 초과 시 "Fix" 버튼으로 쉽게 조정 가능
- [x] 직접적인 값 설정 방식을 통한 업데이트 메서드 충돌 방지
- [x] 디버깅을 위한 콘솔 로그 출력 추가
- [x] 캐싱 메커니즘 개선으로 성능 최적화
- [x] 무한 재귀 방지 로직 구현으로 CPU 사용량 최적화
- [x] enum 속성 관리 최적화로 UI 반응성 개선

## 14. 해결된 버그 및 문제점
- [x] `LensManagerProperties`의 enum 속성 초기화 및 기본값 설정 문제 해결
- [x] 렌즈 시프트 업데이트 함수의 한쪽 방향 지연 문제 수정
- [x] `LENS_OT_force_within_limits` 오퍼레이터 등록 누락 문제 해결
- [x] 프로젝터 생성 시 렌즈 관리자 초기화 문제 해결
- [x] 재귀 호출로 인한 성능 저하 및 오류 문제 해결
- [x] UI에서 "None" 옵션 누락 문제 해결